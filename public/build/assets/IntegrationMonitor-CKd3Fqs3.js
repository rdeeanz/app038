import{S as De,i as Le,s as Pe,d as D,a as Re,t as je,b as qe,c as L,m as Ee,e as x,f as Oe,o as Ue,p as le,q as Ae,h as l,j as a,l as r,N as xe,g as N,k as C,u as ze,v as we,r as Be}from"./app-BhE3jarQ.js";import{A as Fe}from"./AppLayout-BfVQ8FrY.js";import{a as ie}from"./api-BX241UDV.js";function ke(n,e,t){const s=n.slice();return s[13]=e[t],s}function Se(n,e,t){const s=n.slice();s[16]=e[t];const g=s[5][s[16].id];return s[17]=g,s}function Ce(n){let e,t;return{c(){e=a("div"),t=C(n[4]),r(e,"class","mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded")},m(s,g){L(s,e,g),l(e,t)},p(s,g){g&16&&N(t,s[4])},d(s){s&&D(e)}}}function Ge(n){let e;return{c(){e=a("div"),r(e,"class","h-4 w-4 bg-gray-300 rounded-full")},m(t,s){L(t,e,s)},d(t){t&&D(e)}}}function Je(n){let e;return{c(){e=a("div"),r(e,"class","h-4 w-4 bg-red-400 rounded-full")},m(t,s){L(t,e,s)},d(t){t&&D(e)}}}function Ke(n){let e;return{c(){e=a("div"),r(e,"class","h-4 w-4 bg-green-400 rounded-full")},m(t,s){L(t,e,s)},d(t){t&&D(e)}}}function He(n){let e,t=n[17].message+"",s,g;return{c(){e=a("div"),s=C(t),r(e,"class",g="mt-4 p-3 bg-gray-50 rounded text-sm "+(n[17].connected?"text-green-700":"text-red-700"))},m(i,u){L(i,e,u),l(e,s)},p(i,u){u&34&&t!==(t=i[17].message+"")&&N(s,t),u&34&&g!==(g="mt-4 p-3 bg-gray-50 rounded text-sm "+(i[17].connected?"text-green-700":"text-red-700"))&&r(e,"class",g)},d(i){i&&D(e)}}}function Ne(n){var _e,ye,he;let e,t,s,g,i,u,f,d=(n[16].name||"SAP Integration")+"",v,p,w,_,S=n[3]?"Testing...":"Test Connection",b,P,c,h,o,y,m,A,U,O,R=(n[16].type||"OData")+"",j,z,q,k,I,B,Q=(_e=n[17])!=null&&_e.connected?"Connected":((ye=n[17])==null?void 0:ye.connected)===!1?"Disconnected":"Unknown",ne,V,oe,F,W,ce,X,Y=(n[16].last_sync||"Never")+"",se,de,G,Z,ue,$,ee=(n[16].total_syncs||0)+"",ae,fe,pe,re,ge;function me(M,T){var J,K;return(J=M[17])!=null&&J.connected?Ke:((K=M[17])==null?void 0:K.connected)===!1?Je:Ge}let te=me(n),E=te(n);function Ie(){return n[10](n[16])}function Me(){return n[11](n[16])}let H=((he=n[17])==null?void 0:he.message)&&He(n);return{c(){var M;e=a("div"),t=a("div"),s=a("div"),g=a("div"),i=a("div"),E.c(),u=x(),f=a("h3"),v=C(d),p=x(),w=a("div"),_=a("button"),b=C(S),P=x(),c=a("button"),h=C("Sync Products"),o=x(),y=a("div"),m=a("div"),A=a("span"),A.textContent="Type:",U=x(),O=a("span"),j=C(R),z=x(),q=a("div"),k=a("span"),k.textContent="Status:",I=x(),B=a("span"),ne=C(Q),oe=x(),F=a("div"),W=a("span"),W.textContent="Last Sync:",ce=x(),X=a("span"),se=C(Y),de=x(),G=a("div"),Z=a("span"),Z.textContent="Total Syncs:",ue=x(),$=a("span"),ae=C(ee),fe=x(),H&&H.c(),pe=x(),r(i,"class","flex-shrink-0"),r(f,"class","ml-3 text-lg font-medium text-gray-900"),r(g,"class","flex items-center"),_.disabled=n[3],r(_,"class","px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 disabled:opacity-50"),c.disabled=n[3],r(c,"class","px-4 py-2 text-sm font-medium text-green-600 bg-green-50 rounded-md hover:bg-green-100 disabled:opacity-50"),r(w,"class","flex space-x-2"),r(s,"class","flex items-center justify-between mb-4"),r(A,"class","text-gray-500"),r(O,"class","ml-2 font-medium text-gray-900"),r(k,"class","text-gray-500"),r(B,"class",V="ml-2 font-medium "+((M=n[17])!=null&&M.connected?"text-green-600":"text-red-600")),r(W,"class","text-gray-500"),r(X,"class","ml-2 font-medium text-gray-900"),r(Z,"class","text-gray-500"),r($,"class","ml-2 font-medium text-gray-900"),r(y,"class","grid grid-cols-2 gap-4 text-sm"),r(t,"class","px-4 py-5 sm:p-6"),r(e,"class","bg-white shadow rounded-lg overflow-hidden")},m(M,T){L(M,e,T),l(e,t),l(t,s),l(s,g),l(g,i),E.m(i,null),l(g,u),l(g,f),l(f,v),l(s,p),l(s,w),l(w,_),l(_,b),l(w,P),l(w,c),l(c,h),l(t,o),l(t,y),l(y,m),l(m,A),l(m,U),l(m,O),l(O,j),l(y,z),l(y,q),l(q,k),l(q,I),l(q,B),l(B,ne),l(y,oe),l(y,F),l(F,W),l(F,ce),l(F,X),l(X,se),l(y,de),l(y,G),l(G,Z),l(G,ue),l(G,$),l($,ae),l(t,fe),H&&H.m(t,null),l(e,pe),re||(ge=[we(_,"click",Ie),we(c,"click",Me)],re=!0)},p(M,T){var J,K,be,ve;n=M,te!==(te=me(n))&&(E.d(1),E=te(n),E&&(E.c(),E.m(i,null))),T&2&&d!==(d=(n[16].name||"SAP Integration")+"")&&N(v,d),T&8&&S!==(S=n[3]?"Testing...":"Test Connection")&&N(b,S),T&8&&(_.disabled=n[3]),T&8&&(c.disabled=n[3]),T&2&&R!==(R=(n[16].type||"OData")+"")&&N(j,R),T&34&&Q!==(Q=(J=n[17])!=null&&J.connected?"Connected":((K=n[17])==null?void 0:K.connected)===!1?"Disconnected":"Unknown")&&N(ne,Q),T&34&&V!==(V="ml-2 font-medium "+((be=n[17])!=null&&be.connected?"text-green-600":"text-red-600"))&&r(B,"class",V),T&2&&Y!==(Y=(n[16].last_sync||"Never")+"")&&N(se,Y),T&2&&ee!==(ee=(n[16].total_syncs||0)+"")&&N(ae,ee),(ve=n[17])!=null&&ve.message?H?H.p(n,T):(H=He(n),H.c(),H.m(t,null)):H&&(H.d(1),H=null)},d(M){M&&D(e),E.d(),H&&H.d(),re=!1,ze(ge)}}}function Qe(n){let e;return{c(){e=a("p"),e.textContent="No sync history available.",r(e,"class","text-sm text-gray-500")},m(t,s){L(t,e,s)},p:Be,d(t){t&&D(e)}}}function Ve(n){let e,t,s,g,i,u=le(n[2]),f=[];for(let d=0;d<u.length;d+=1)f[d]=Te(ke(n,u,d));return{c(){e=a("div"),t=a("table"),s=a("thead"),s.innerHTML='<tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sync ID</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Records</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Started</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Completed</th></tr>',g=x(),i=a("tbody");for(let d=0;d<f.length;d+=1)f[d].c();r(s,"class","bg-gray-50"),r(i,"class","bg-white divide-y divide-gray-200"),r(t,"class","min-w-full divide-y divide-gray-200"),r(e,"class","overflow-x-auto")},m(d,v){L(d,e,v),l(e,t),l(t,s),l(t,g),l(t,i);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(i,null)},p(d,v){if(v&4){u=le(d[2]);let p;for(p=0;p<u.length;p+=1){const w=ke(d,u,p);f[p]?f[p].p(w,v):(f[p]=Te(w),f[p].c(),f[p].m(i,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=u.length}},d(d){d&&D(e),Ae(f,d)}}}function Te(n){let e,t,s=n[13].sync_id+"",g,i,u,f=(n[13].type||"N/A")+"",d,v,p,w,_=(n[13].status||"pending")+"",S,b,P,c,h=(n[13].records_synced||0)+"",o,y,m,A=(n[13].started_at||"N/A")+"",U,O,R,j=(n[13].completed_at||"-")+"",z,q;return{c(){e=a("tr"),t=a("td"),g=C(s),i=x(),u=a("td"),d=C(f),v=x(),p=a("td"),w=a("span"),S=C(_),P=x(),c=a("td"),o=C(h),y=x(),m=a("td"),U=C(A),O=x(),R=a("td"),z=C(j),q=x(),r(t,"class","px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900"),r(u,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),r(w,"class",b="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(n[13].status==="completed"?"bg-green-100 text-green-800":n[13].status==="processing"?"bg-blue-100 text-blue-800":n[13].status==="failed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800")),r(p,"class","px-6 py-4 whitespace-nowrap"),r(c,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-900"),r(m,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),r(R,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),r(e,"class","hover:bg-gray-50")},m(k,I){L(k,e,I),l(e,t),l(t,g),l(e,i),l(e,u),l(u,d),l(e,v),l(e,p),l(p,w),l(w,S),l(e,P),l(e,c),l(c,o),l(e,y),l(e,m),l(m,U),l(e,O),l(e,R),l(R,z),l(e,q)},p(k,I){I&4&&s!==(s=k[13].sync_id+"")&&N(g,s),I&4&&f!==(f=(k[13].type||"N/A")+"")&&N(d,f),I&4&&_!==(_=(k[13].status||"pending")+"")&&N(S,_),I&4&&b!==(b="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(k[13].status==="completed"?"bg-green-100 text-green-800":k[13].status==="processing"?"bg-blue-100 text-blue-800":k[13].status==="failed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"))&&r(w,"class",b),I&4&&h!==(h=(k[13].records_synced||0)+"")&&N(o,h),I&4&&A!==(A=(k[13].started_at||"N/A")+"")&&N(U,A),I&4&&j!==(j=(k[13].completed_at||"-")+"")&&N(z,j)},d(k){k&&D(e)}}}function We(n){let e,t,s,g,i,u,f,d,v,p,w,_=n[4]&&Ce(n),S=le(n[1]),b=[];for(let o=0;o<S.length;o+=1)b[o]=Ne(Se(n,S,o));function P(o,y){return o[2]&&o[2].length>0?Ve:Qe}let c=P(n),h=c(n);return{c(){e=a("div"),t=a("div"),s=a("div"),s.innerHTML='<h1 class="text-3xl font-bold text-gray-900">Integration Monitor</h1> <p class="mt-2 text-sm text-gray-600">Monitor and manage ERP integrations</p>',g=x(),_&&_.c(),i=x(),u=a("div");for(let o=0;o<b.length;o+=1)b[o].c();f=x(),d=a("div"),v=a("div"),p=a("h3"),p.textContent="Sync History",w=x(),h.c(),r(s,"class","mb-8"),r(u,"class","grid grid-cols-1 gap-6 mb-8"),r(p,"class","text-lg font-medium text-gray-900 mb-4"),r(v,"class","px-4 py-5 sm:p-6"),r(d,"class","bg-white shadow rounded-lg"),r(t,"class","max-w-7xl mx-auto sm:px-6 lg:px-8"),r(e,"class","py-12")},m(o,y){L(o,e,y),l(e,t),l(t,s),l(t,g),_&&_.m(t,null),l(t,i),l(t,u);for(let m=0;m<b.length;m+=1)b[m]&&b[m].m(u,null);l(t,f),l(t,d),l(d,v),l(v,p),l(v,w),h.m(v,null)},p(o,y){if(o[4]?_?_.p(o,y):(_=Ce(o),_.c(),_.m(t,i)):_&&(_.d(1),_=null),y&234){S=le(o[1]);let m;for(m=0;m<S.length;m+=1){const A=Se(o,S,m);b[m]?b[m].p(A,y):(b[m]=Ne(A),b[m].c(),b[m].m(u,null))}for(;m<b.length;m+=1)b[m].d(1);b.length=S.length}c===(c=P(o))&&h?h.p(o,y):(h.d(1),h=c(o),h&&(h.c(),h.m(v,null)))},d(o){o&&D(e),_&&_.d(),Ae(b,o),h.d()}}}function Xe(n){var g;let e,t,s;return t=new Fe({props:{user:(g=n[0])==null?void 0:g.user,$$slots:{default:[We]},$$scope:{ctx:n}}}),{c(){e=x(),Oe(t.$$.fragment),document.title="Integration Monitor"},m(i,u){L(i,e,u),Ee(t,i,u),s=!0},p(i,[u]){var d;const f={};u&1&&(f.user=(d=i[0])==null?void 0:d.user),u&1048638&&(f.$$scope={dirty:u,ctx:i}),t.$set(f)},i(i){s||(qe(t.$$.fragment,i),s=!0)},o(i){je(t.$$.fragment,i),s=!1},d(i){i&&D(e),Re(t,i)}}}function Ye(n,e,t){let{auth:s=null}=e,{integrations:g=[]}=e,{syncHistory:i=[]}=e,{errors:u={}}=e,{flash:f={}}=e,d=!1,v=null,p={};async function w(c){var h,o;t(3,d=!0),t(4,v=null);try{const y=await ie.post("/erp-integration/test-connection",{integration_id:c});t(5,p={...p,[c]:y.data})}catch(y){t(4,v=((o=(h=y.response)==null?void 0:h.data)==null?void 0:o.message)||"Connection test failed"),console.error("Connection test error:",y)}finally{t(3,d=!1)}}async function _(c,h="products"){var o,y;t(3,d=!0),t(4,v=null);try{const m=await ie.post("/erp-integration/sync",{type:h,endpoint:`/api/${h}`,priority:"normal"});xe.reload({only:["syncHistory"]})}catch(m){t(4,v=((y=(o=m.response)==null?void 0:o.data)==null?void 0:y.message)||"Sync failed"),console.error("Sync error:",m)}finally{t(3,d=!1)}}async function S(c){try{await ie.get(`/erp-integration/sync/${c}/status`),xe.reload({only:["syncHistory"]})}catch(h){console.error("Status check error:",h)}}Ue(()=>{const c=setInterval(()=>{i.filter(o=>o.status==="pending").forEach(o=>{S(o.sync_id)})},5e3);return()=>clearInterval(c)});const b=c=>w(c.id),P=c=>_(c.id,"products");return n.$$set=c=>{"auth"in c&&t(0,s=c.auth),"integrations"in c&&t(1,g=c.integrations),"syncHistory"in c&&t(2,i=c.syncHistory),"errors"in c&&t(8,u=c.errors),"flash"in c&&t(9,f=c.flash)},[s,g,i,d,v,p,w,_,u,f,b,P]}class tt extends De{constructor(e){super(),Le(this,e,Ye,Xe,Pe,{auth:0,integrations:1,syncHistory:2,errors:8,flash:9})}}export{tt as default};
